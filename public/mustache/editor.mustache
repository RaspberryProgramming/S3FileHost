 <!doctype html>
 <html>

 <head>
     <link rel="stylesheet" type="text/css" href="/css/editor.css">
     <meta name="viewport" content="width=device-width" />
 </head>

 <body>
 <div class="content" id="content">{{{editor}}}</div>
 </body>

 </html>
 <script>
 document.addEventListener("keydown", function(e) {
  if ((window.navigator.platform.match("Mac") ? e.metaKey : e.ctrlKey)  && e.keyCode == 83) {
    e.preventDefault();

    let file = '{{{file}}}'.split(".");
    extension = file[file.length-1];
    if (extension === "txt" || extension === "text"){
        savetxt();
    }
  }
}, false);

 function assemblePath(pathArray){
         let path = "";
         for (i in pathArray){
                 path += "/" + pathArray[i];
                 }
         
         return path;
 }

function savetxt(){

 let textbox = document.getElementById("textbox");
 let data = textbox.value;
  console.log( 'Sending data' );
  let filename = '{{{file}}}';
  let uploadpath = window.location.pathname.split("/");
  uploadpath.shift();
  uploadpath.shift();
  uploadpath.pop();
  console.log(uploadpath);
    uploadpath = "/upload" + assemblePath(uploadpath);
  var xhr = new XMLHttpRequest();
xhr.open("POST", uploadpath, true);
xhr.setRequestHeader('Content-Type', 'application/json');
xhr.send(JSON.stringify({
    filedata: data,
    filename: filename
}));
console.log(uploadpath);
}

 </script>